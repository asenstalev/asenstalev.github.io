<!DOCTYPE html>
<html>
	<body>
		<h1>
			MY OWN PAGE FOR TEST FRONTEND EMBEDDING FOR MA MESSAGING
		</h1>
		<script type='text/javascript'>
			function initEmbeddedMessaging() {
				try {
					window.parent.window.isLiveChatOpened = false;

					embeddedservice_bootstrap.settings.language = 'de';

					embeddedservice_bootstrap.init(
						'00D3N000000HSap',
						'CB_mA_Messaging_Deployment',
						'https://de-crm--testde.sandbox.my.site.com/ESWCBMessagingChannel1752764676619',
						{
							scrt2URL: 'https://de-crm--testde.sandbox.my.salesforce-scrt.com'
						}
					);
				} catch (err) {
					console.error('Error loading Embedded Messaging: ', err);
				}
			};

			window.addEventListener("onEmbeddedMessagingReady", () => {
				embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({"CB_Country_Code" : "DE", "CB_Tenant" : "mA"});
			});

			window.addEventListener("onEmbeddedMessagingWindowMaximized", () => {
				window.parent.window.isLiveChatOpened = true;
			});

			window.addEventListener("onEmbeddedMessagingWindowMinimized", () => {
				window.parent.window.isLiveChatOpened = false;
			});

			window.addEventListener("onEmbeddedMessagingWindowClosed", () => {
				window.parent.window.isLiveChatOpened = false;
			});
		</script>
		<!--script type='text/javascript' src='https://de-crm--testde.sandbox.my.site.com/ESWCBMessagingChannel1752764676619/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script-->
		<script type='text/javascript'>
			// Function to load the bootstrap script dynamically
			function loadBootstrapScript() {
				var config = window.chatConfig || {};
				var bootstrapScriptSrc = 'https://de-crm--testde.sandbox.my.site.com/ESWCBMessagingChannel1752764676619/assets/js/bootstrap.min.js';

				var script = document.createElement('script');
				script.type = 'text/javascript';
				script.src = bootstrapScriptSrc;
				script.onload = initEmbeddedMessaging;
				document.body.appendChild(script);
			}

			// Check if chatConfig is already available
			if (window.chatConfig) {
				loadBootstrapScript();
			} else {
				// Wait a short time for chatConfig to be set by parent window
				setTimeout(function() {
					loadBootstrapScript();
				}, 500);
			}
		</script>
	</body>
</html>